inherited A171FXMLVisiteFiscaliMW: TA171FXMLVisiteFiscaliMW
  OldCreateOrder = True
  OnDestroy = DataModuleDestroy
  Height = 365
  Width = 810
  object selT430: TOracleDataSet
    SQL.Strings = (
      
        'select T030.COGNOME, T030.NOME, T430.PROGRESSIVO, T430.AZIENDA_B' +
        'ASE,'
      
        '       T430.INDIRIZZO, T430.COMUNE, T480.CITTA, T430.CAP, T480.C' +
        'ODCATASTALE CODICE_RES, T480.PROVINCIA PROV_RES, T481.DESCRIZION' +
        'E DESC_PROV_RES,'
      
        '       T430.INDIRIZZO_DOM_BASE, T430.COMUNE_DOM_BASE, T480D.CITT' +
        'A CITTA_DOM, T430.CAP_DOM_BASE, T430.TELEFONO,'
      '       T480D.CODCATASTALE CODICE_DOM, T480D.PROVINCIA PROV_DOM,'
      '       T481D.DESCRIZIONE DESC_PROV_DOM'
      
        '  from T030_ANAGRAFICO T030, T430_STORICO T430, T480_COMUNI T480' +
        ', T480_COMUNI T480D, T481_PROVINCE T481,T481_PROVINCE T481D'
      ' where T030.PROGRESSIVO = T430.PROGRESSIVO'
      '   and :DATA between T430.DATADECORRENZA and T430.DATAFINE'
      '   and T430.COMUNE = T480.CODICE(+) '
      '   and T430.COMUNE_DOM_BASE = T480D.CODICE(+) '
      '   and T480.PROVINCIA = T481.COD_PROVINCIA(+)'
      '   and T480D.PROVINCIA = T481D.COD_PROVINCIA(+)'
      ' order by T430.PROGRESSIVO')
    ReadBuffer = 10000
    Optimize = False
    Variables.Data = {
      04000000010000000A0000003A0044004100540041000C000000000000000000
      0000}
    Left = 24
    Top = 7
  end
  object selT480: TOracleDataSet
    SQL.Strings = (
      
        'select T480.CODCATASTALE, T480.CITTA, T480.CAP, T480.PROVINCIA, ' +
        'T481.DESCRIZIONE, T480.CODICE'
      '  from T480_COMUNI T480, T481_PROVINCE T481'
      ' where T480.PROVINCIA = T481.COD_PROVINCIA'
      '   and T480.CODCATASTALE is not null'
      ' order by T480.CITTA')
    ReadBuffer = 100
    Optimize = False
    Left = 80
    Top = 7
  end
  object selT049UltimaVisita: TOracleDataSet
    SQL.Strings = (
      'select T049.PROGRESSIVO, max(T049.DATA_VISITA) as ULTIMA_VISITA'
      '  from T049_XMLVISITEFISCALI T049'
      ' where T049.DATA_VISITA is not null'
      '   and T049.ELABORATO = '#39'S'#39
      ' group by T049.PROGRESSIVO')
    ReadBuffer = 50
    Optimize = False
    Left = 208
    Top = 7
  end
  object selP500: TOracleDataSet
    SQL.Strings = (
      'select P500.*'
      '  from P500_CUDSETUP P500'
      ' where P500.ANNO = (select max(ANNO)'
      '                      from P500_CUDSETUP'
      '                     where ANNO <= :ANNO'
      
        '                       and COD_AZIENDA_BASE = P500.COD_AZIENDA_B' +
        'ASE)')
    Optimize = False
    Variables.Data = {
      04000000010000000A0000003A0041004E004E004F0003000000000000000000
      0000}
    Left = 136
    Top = 7
  end
  object dsrT480: TDataSource
    DataSet = selT480
    Left = 80
    Top = 63
  end
  object delT049: TOracleQuery
    SQL.Strings = (
      'delete'
      '  from T049_XMLVISITEFISCALI T049'
      ' where T049.DATA_RICHIESTA between :DATADA and :DATAA'
      '       :ELABORATO')
    Optimize = False
    Variables.Data = {
      04000000030000000E0000003A004400410054004100440041000C0000000000
      0000000000000C0000003A00440041005400410041000C000000000000000000
      0000140000003A0045004C00410042004F005200410054004F00010000000000
      000000000000}
    Left = 82
    Top = 112
  end
  object selT265_T260: TOracleQuery
    SQL.Strings = (
      'select count(*) as MALATTIA_FERIE'
      '  from T040_GIUSTIFICATIVI T040'
      ' where T040.CAUSALE in (select T265.CODICE'
      
        '                          from T265_CAUASSENZE T265, T260_RAGGRA' +
        'SSENZE T260'
      '                         where T265.CODRAGGR = T260.CODICE'
      '                           and T260.CODINTERNO = '#39'A'#39')'
      '   and T040.DATA between :DATADA and nvl(:DATAA, :DATADA)'
      '   and T040.PROGRESSIVO = :PROGRESSIVO')
    Optimize = False
    Variables.Data = {
      04000000030000000E0000003A004400410054004100440041000C0000000000
      0000000000000C0000003A00440041005400410041000C000000000000000000
      0000180000003A00500052004F0047005200450053005300490056004F000300
      00000000000000000000}
    Left = 298
    Top = 112
  end
  object updT049_ELABORATO: TOracleQuery
    SQL.Strings = (
      'update T049_XMLVISITEFISCALI T049'
      '   set T049.ELABORATO = '#39'S'#39
      ' where T049.DATA_RICHIESTA between :DATADA and :DATAA'
      '   and T049.ELABORATO = '#39'N'#39)
    Optimize = False
    Variables.Data = {
      04000000020000000E0000003A004400410054004100440041000C0000000000
      0000000000000C0000003A00440041005400410041000C000000000000000000
      0000}
    Left = 248
    Top = 191
  end
  object insT049: TOracleQuery
    SQL.Strings = (
      'insert into T049_XMLVISITEFISCALI'
      
        '(PROGRESSIVO, DATA_RICHIESTA, ORA_RICHIESTA, INIZIO_MAL, FINE_MA' +
        'L, MALATTIA_FERIE, DATA_VISITA, COGNOME_REP, CODCATASTALE_REP, C' +
        'AP_REP, VIA_REP, DETTAGLI_INDIRIZZO, TELEFONO)'
      'values'
      
        '(:PROGRESSIVO, :DATA_RICHIESTA, :ORA_RICHIESTA, :INIZIO_MAL, :FI' +
        'NE_MAL, :MALATTIA_FERIE, :DATA_VISITA, :COGNOME_REP, :CODCATASTA' +
        'LE_REP, :CAP_REP, :VIA_REP, :DETTAGLI_INDIRIZZO, :TELEFONO)')
    Optimize = False
    Variables.Data = {
      040000000D000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000001E0000003A0044004100540041005F00
      5200490043004800490045005300540041000C00000000000000000000001C00
      00003A004F00520041005F005200490043004800490045005300540041000500
      00000000000000000000160000003A0049004E0049005A0049004F005F004D00
      41004C000C00000000000000000000001E0000003A004D0041004C0041005400
      5400490041005F00460045005200490045000500000000000000000000001800
      00003A0044004100540041005F005600490053004900540041000C0000000000
      000000000000120000003A00460049004E0045005F004D0041004C000C000000
      0000000000000000180000003A0043004F0047004E004F004D0045005F005200
      45005000050000000000000000000000220000003A0043004F00440043004100
      540041005300540041004C0045005F0052004500500005000000000000000000
      0000100000003A004300410050005F0052004500500005000000000000000000
      0000100000003A005600490041005F0052004500500005000000000000000000
      0000260000003A004400450054005400410047004C0049005F0049004E004400
      4900520049005A005A004F00050000000000000000000000120000003A005400
      45004C00450046004F004E004F00050000000000000000000000}
    Left = 29
    Top = 112
  end
  object CountT049Richieste: TOracleQuery
    SQL.Strings = (
      'select count(*) as NUMREC'
      '  from T049_XMLVISITEFISCALI T049'
      ' where T049.DATA_RICHIESTA between :DATADA and :DATAA'
      '   and T049.ELABORATO = '#39'N'#39)
    Optimize = False
    Variables.Data = {
      04000000020000000E0000003A004400410054004100440041000C0000000000
      0000000000000C0000003A00440041005400410041000C000000000000000000
      0000}
    Left = 104
    Top = 191
  end
  object updT049_CopiaConfig: TOracleQuery
    SQL.Strings = (
      'update T049_XMLVISITEFISCALI T049'
      '   set :AGGIORNA'
      ' where T049.DATA_RICHIESTA between :DATADA and :DATAA'
      '       :ELABORATO')
    Optimize = False
    Variables.Data = {
      04000000040000000E0000003A004400410054004100440041000C0000000000
      0000000000000C0000003A00440041005400410041000C000000000000000000
      0000140000003A0045004C00410042004F005200410054004F00010000000000
      000000000000120000003A0041004700470049004F0052004E00410001000000
      0000000000000000}
    Left = 168
    Top = 112
  end
  object selT049NumRec: TOracleQuery
    SQL.Strings = (
      '/*'
      'Verifico se il progressivo sia stato gi'#224' inserito'
      '*/'
      'select count(*) as NUMREC'
      '  from T049_XMLVISITEFISCALI T049'
      ' where T049.PROGRESSIVO = :PROGRESSIVO'
      '   and T049.DATA_RICHIESTA = :DATA_RICHIESTA')
    Optimize = False
    Variables.Data = {
      0400000002000000180000003A00500052004F00470052004500530053004900
      56004F000300000000000000000000001E0000003A0044004100540041005F00
      5200490043004800490045005300540041000C0000000000000000000000}
    Left = 384
    Top = 191
  end
  object selT030_GetProgressivo: TOracleDataSet
    SQL.Strings = (
      'select T030.PROGRESSIVO'
      '  from T030_ANAGRAFICO T030, T430_STORICO T430'
      ' where T030.CODFISCALE = :CODFISCALE'
      '   and T030.PROGRESSIVO = T430.PROGRESSIVO'
      '   and :DECORRENZA between T430.DATADECORRENZA and T430.DATAFINE'
      
        '   and :DECORRENZA between T430.INIZIO and nvl(T430.FINE, to_dat' +
        'e('#39'31/12/3999'#39','#39'DD/MM/YYYY'#39'))')
    Optimize = False
    Variables.Data = {
      0400000002000000160000003A0043004F004400460049005300430041004C00
      4500050000000000000000000000160000003A004400450043004F0052005200
      45004E005A0041000C0000000000000000000000}
    Left = 320
    Top = 8
  end
  object selT047: TOracleDataSet
    SQL.Strings = (
      
        'select T047.*, T047.INDIRIZZO || '#39' - '#39' || T480.CITTA || '#39'('#39' || T' +
        '047.CAP || '#39') '#39' DATI_INDIR '
      'from T047_VISITEFISCALI T047, T480_COMUNI T480'
      
        'where (TRUNC(T047.DATA_PRIMA_COMUNICAZIONE) = TRUNC(SYSDATE) or ' +
        'TRUNC(T047.DATA_COMUN_PROLUNGAMENTO) = TRUNC(SYSDATE))'
      '  and T047.TIPO_ESENZIONE IS NULL'
      '  and T047.COD_COMUNE = T480.CODICE (+)')
    Optimize = False
    Left = 448
    Top = 8
  end
  object selT480_Dett: TOracleDataSet
    SQL.Strings = (
      
        'select T480.CODICE, T480.CODCATASTALE, T480.CITTA, T481.COD_PROV' +
        'INCIA, T481.DESCRIZIONE'
      '  from T481_PROVINCE T481, T480_COMUNI T480'
      ' where T481.COD_PROVINCIA = T480.PROVINCIA'
      ' order by T480.CODICE')
    ReadBuffer = 10000
    Optimize = False
    Left = 520
    Top = 8
  end
  object selT048: TOracleDataSet
    SQL.Strings = (
      
        'select T048.*, T048.VIA_REP || '#39' - '#39' || T480.CITTA || '#39'('#39' || T04' +
        '8.CAP_REP || '#39') '#39' || DECODE(NVL(T048.COGNOME_REP,'#39#39'),'#39#39','#39#39','#39' - C' +
        'ognome '#39' || T048.COGNOME_REP) DATI_REP'
      'from T048_ATTESTATIINPS T048, T480_COMUNI T480'
      'where T048.PROGRESSIVO = :Progressivo'
      '  and T048.DATA_INIZIO_MAL = :InizioMal'
      '  and T048.CODCATASTALE_REP = T480.CODCATASTALE (+)'
      'ORDER BY DATA_REGISTRAZIONE DESC')
    Optimize = False
    Variables.Data = {
      0400000002000000180000003A00500052004F00470052004500530053004900
      56004F00030000000000000000000000140000003A0049004E0049005A004900
      4F004D0041004C000C0000000000000000000000}
    Left = 448
    Top = 64
  end
end
